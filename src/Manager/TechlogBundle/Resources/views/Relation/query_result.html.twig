<style>
    td a {text-decoration:underline;color:blue;} /* 修改默认链接样式 */
</style>
<h4>总数：{{ total }}</h4>
<div class="gigantic pagination" style="float:right; margin:5px" >
    <a href="#" class="first" data-action="first">&laquo;</a>
    <a href="#" class="previous" data-action="previous">&lsaquo;</a>
    <input type="text" readonly="readonly" data-max-page="40" />
    <a href="#" class="next" data-action="next">&rsaquo;</a>
    <a href="#" class="last" data-action="last">&raquo;</a>
</div>
<div style="float:right; margin:5px" >
    <form>
    <span class="field">
        <label>每页显示：</label>
        <input type="text" id="limit" name="limit" class="supperminiinput" value="{{ limit }}"/>（上限1000）
    </span>
    </form>
</div>
<p>&nbsp;</p>
<form>
    <table id="logo_table" cellpadding="0" cellspacing="0" border="0" class="stdtable">
        <thead class="center">
            <tr>
                {% for key,value in key_value_map if value['width'] is defined %}
				<td width="{{ value['width'] }}%"><a href="javascript:void(0)" onclick="query_result('{{ key }}')">{{ value['name'] }}</a></td>
                {% endfor %}
                <td width="4%">操作</td>
            </tr>
        </thead>
        <tbody class="center">
            {% for info in data %}
            <tr>
                {% for key,value in key_value_map if value['width'] is defined %}
                {% if key in select_list|keys and select_list[key][info[key]] is defined %}
                <td>{{ select_list[key][info[key]] }}</td>
                {% else %}
				<td>
					{% if key == 'tag_name' %}
					<a href="http://techlog.cn/html/debin.php?category=0&tags=icon_tag_{{ info['tag_id'] }}" target="_blank">
					{% elseif key == 'title' %}
					<a href="http://techlog.cn/html/article.php?id={{ info['article_id'] }}" target="_blank">
					{% endif %}
					{{ info[key] }}
					{% if key == 'tag_nage' or key == 'title' %}
					</a>
					{% endif %}
				</td>
                {% endif %}
                {% endfor %}
                <td>
					<a class="btnstyle" href="javascript:void(0)" onclick="delete_func('{{ info['article_id'] }}', '{{ info['tag_id'] }}')">删除</button>
					<a class="btnstyle" style="margin-left:5px;" href="{{ path('techlog_manager_relation_add', {'article_id':info['article_id'], 'title':info['title']}) }}">添加</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</form>

<div class="gigantic pagination">
    <a href="#" class="first" data-action="first">&laquo;</a>
    <a href="#" class="previous" data-action="previous">&lsaquo;</a>
    <input type="text" readonly="readonly" data-max-page="40" />
    <a href="#" class="next" data-action="next">&rsaquo;</a>
    <a href="#" class="last" data-action="last">&raquo;</a>
</div>
<input type="hidden" id="totalPages" value="{{ totalPages }}"/>
<input type="hidden" id="start" value="{{ start }}"/>
<input type="hidden" id="asc" value="{{ asc }}"/>
<input type="hidden" id="sortby" value="{{ sortby }}"/>

<script type="text/javascript">
function delete_func(article_id, tag_id)
{
	var params = {'article_id':article_id, 'tag_id':tag_id};
	jConfirm(
		'请确认是否删除',
		'确认',
		function(r)
		{
			if (r)
			{
				$.ajax(
					{
						'url'		: '{{ path('techlog_manager_relation_del') }}',
						'type'		: 'post',
						'data'		: params,
						'dataType'	: 'json',
						'error' : function (jqXHR, textStatus, errorThrown)
						{
							hideProgress();
							var errMsg = errorThrown == 'Forbidden' ? '亲，没权限呢!' : '亲，服务器忙着呢!';
							jAlert(errMsg, '提示');
						},
						'success'	: function(data)
						{
							jAlert(data['msg'], '提示', function()
								{
									if (data['code'] == 0)
									{
										location = data['url'];
									}
								}
							);
						}
					}
				);
			}
		}
	);
	return false;
}
</script>
